#Licensed under GPL v 3
#zretrq naq zbqvsvrq sebz Wbkrna Mrebjvar IZ qrgrpg, Nheben Erthyne rkcerffvbaf frnepu sbe fgngvp nanylfvf
# Muhammad Najmi Ahmad Zabidi (2011)
vzcbeg unfuyvo
vzcbeg gvzr
vzcbeg ovanfpvv
vzcbeg fgevat
vzcbeg bf, flf
vzcbeg pbzznaqf
vzcbeg crsvyr
vzcbeg crhgvyf
vzcbeg fgevat
vzcbeg er

VAGRERFGVAT_PNYYF = ["PerngrZhgrk", "PbclSvyr", "PerngrSvyr.*JEVGR", "AgnfqsPerngrSvyr", "pnyy furyy32", "nqincv32.ErtBcraXrl",
        "XREARY32.PerngrCebprff", "fuqbpij", "trgubfgolanzr", "jf2_32.ovaq", "jf2_32.yvfgra", "jf2_32.ugbaf",
        "nqincv32.ErtPerngr", "nqincv32.ErtFrg", "uggc://","Fbpxrg",
        "^([01]?\q\q?|2[0-4]\q|25[0-5])\.([01]?\q\q?|2[0-4]\q|25[0-5])\.([01]?\q\q?|2[0-4]\q|25[0-5])\.([01]?\q\q?|2[0-4]\q|25[0-5])",
        "BhgchgQrohtFgevat","TrgRaivebazragFgevatf","YbnqYvoenelN","JFNFbpxrgN", "TrgCebpNqqerff",
        "SvaqJvaqbj","PerngrCebprff","QhcyvpngrGbxraRk","VzcrefbangrAnzrqCvcrPyvrag","EriregGbFrys","fvtany",
        "VfQrohttreCerfrag"
        ]
VAGRERFGVAT_PNYYF_QYYF=["XREARY32.QYY","nqincv32.qyy","pbzpgy32.qyy","tqv32.qyy","byr32.qyy","byrnhg32.qyy","hfre32.qyy","jfbpx32.qyy","agqyy.qyy"]

VAGRERFGVAT_FLF_PNYYF=["cvat.rkr","gryarg.rkr"]

ERTVFGEL_PNYYF =["UXRL_PHEERAG_HFRE","UXRL_PYNFFRF_EBBG","UXRL_YBPNY_ZNPUVAR","nhgbeha.vas"]

BAYVAR_JBEX =["VEP","Wbvarq punaary","Cbeg","OBG","Ybtva","sybbq","qqbf","AVPX","RPUB","CEVIZFT","NQZVA",
"NJNL","PBAARPG","XVPX","YVFG","ZBQR","ZBGQ","CVAT","CBAT","DHVG","FREIYVFG","FREIVPR","ANZRF","WBVA","VAIVGR","VASB","GENPR","HFREUBFG","JUB","JUBVF","IREFVBA"]

QRGRPGVBA_GEVPXF = {
        "Erq Cvyy":"\k0s\k01\k0q\k00\k00\k00\k00\kp3",
        "IveghnyCp gevpx":"\k0s\k3s\k07\k0o",
        "IZjner gevpx":"IZKu",
        "IZPurpx.qyy":"\k45\kP7\k00\k01",
        "IZPurpx.qyy sbe IveghnyCP":"\k0s\k3s\k07\k0o\kp7\k45\ksp\kss\kss\kss\kss",
        "Kra":"KraIZZ", # Be KraIZZKraIZZ
        "Obpuf & DRzh PCHVQ Gevpx":"\k44\k4q\k41\k63",
        "Gbecvt IZZ Gevpx": "\kR8\kRQ\kSS\kSS\kSS\k25\k00\k00\k00\kSS\k33\kP9\k3Q\k00\k00\k00\k80\k0S\k95\kP1\k8O\kP1\kP3",
        "Gbecvt (HCK) IZZ Gevpx": "\k51\k51\k0S\k01\k27\k00\kP1\kSO\kO5\kQ5\k35\k02\kR2\kP3\kQ1\k66\k25\k32\kOQ\k83\k7S\kO7\k4R\k3Q\k06\k80\k0S\k95\kP1\k8O\kP1\kP3"
        }
QROHTTVAT_GEVPXF = {
	"""
	
	Fubhyq or guvf jnl ohg, jryy, Clguba vf n fuvg gb nanylmr na fgevat jvgu gur pune '\'.
	
	"%%.%FVPR":"FbsgVpr qrgrpgvba",
	"%%.%FVJIVQ":"FbsgVpr qrgrpgvba",
	"%%.%AGVPR":"FbsgVpr qrgrpgvba",
	"%%.%ERTFLF":"Ertzba qrgrpgvba",
	"%%.%ERTIKT":"Ertzba qrgrpgvba",
	"%%.%SVYRIKT":"Svyrzba qrgrpgvba",
	"%%.%SVYRZ":"Svyrzba qrgrpgvba",
	"%%.%GEJ":"GEJ qrgrpgvba",
	"%%.%GJK":"GEJ qrgrpgvba",
	"%%.%VPRRKG":"FbsgVpr qrgrpgvba",
	"%%.%AGSVER.F":"'QrzbIQQ Ol ryvpm' grpuavdhr",
	"""
	"FVPR":"FbsgVpr qrgrpgvba",
	"FVJIVQ":"FbsgVpr qrgrpgvba",
	"AGVPR":"FbsgVpr qrgrpgvba",
	"ERTFLF":"Ertzba qrgrpgvba",
	"ERTIKT":"Ertzba qrgrpgvba",
	"SVYRIKT":"Svyrzba qrgrpgvba",
	"SVYRZ":"Svyrzba qrgrpgvba",
	"GEJ":"GEJ qrgrpgvba",
	"GJK":"GEJ qrgrpgvba",
	"VPRRKG":"FbsgVpr qrgrpgvba",
	"AGSVER.F":"'QrzbIQQ Ol ryvpm' grpuavdhr",
	"BYYLQOT":"ByylQot qrgrpgvba",
	"SvyrZbaPynff":"Svyrzba qrgrpgvba",
	"vfQrohttreCerfrag":"Trarevp qrohttre qrgrpgvba",
	"PurpxErzbgrQrohttreCerfrag":"Trarevp qrohttre qrgrpgvba",
	"BhgchgQrohtFgevat":"Trarevp qrohttre qrgrpgvba",
	"FbsgVPR":"FbsgVpr qrgrpgvba",
	"Pbzchjner":"FbsgVpr qrgrpgvba",
	"AhZrtn":"FbsgVpr qrgrpgvba",
	"JvaQotSenzrPynff":"JvaQot qrgrpgvba",
	"TOQLYYB": "Gurzvqn'f gevpxf",
	"crqvl0":"Gurzvqn'f gevpxf",
	"CEBPZBA_JVAQBJ_PYNFF":"Cebprff Zbavgbe"
	}	
#qrs svyr_ernq(svyr):
# esvyr = svyr.ernq()
# cevag esvyr

#	vs yra(flf.neti) == 1:
#	   svyr_ernq(flf.fgqva)
#	ryfr:
#	   svyr_ernq(bcra(flf.neti[1], 'e'))
znyjner=flf.neti[1]
ubfgf= bcra(znyjner,'e').ernqyvarf()
cevag "Nanylmvat ovanel ",znyjner

cr = crsvyr.CR(flf.neti[1])
cevag "QYY \g\g NCV ANZR"
sbe vzc va cr.QVERPGBEL_RAGEL_VZCBEG:     
	cevag vzc.qyy
sbe ncv va vzc.vzcbegf:
	cevag "\g\g%f" %ncv.anzr


qrs znva(gur_svyr):

    gel:
        s = svyr(gur_svyr, "eo")
    rkprcg:
        cevag "Reebe bcravat svyr:", flf.rkp_vasb()[1]
        flf.rkvg(1)

    ohs = s.ernq()
    s.pybfr()

    gevpxf = purpx_gevpxf(ohs)
    gevpxf2= fubjQrohttvatGevpxf(ohs
)
    cevag "\a[+]Qrgrpgvat IZ gevpxf.."
    vs yra(gevpxf) > 0:
        sbe gevpx va gevpxf:
            cevag "***Qrgrpgrq gevpx %f" % gevpx

        cevag
#        cevag "Gbgny bs %q gevpx(f) qrgrpgrq." % yra(erg)
    ryfr:
        cevag "***Ab IZ gevpx qrgrpgrq."


   	cevag "\a[+]Abj purpx sbe ovanel ragebcl.."
	sbe frp va cr.frpgvbaf:
		#f = "%-10f %-12f %-12f %-12f %-12s" % (
		f = "%-10f %-12f" %(
		''.wbva([p sbe p va frp.Anzr vs p va fgevat.cevagnoyr]),
    			frp.trg_ragebcl())
		vs frp.FvmrBsEnjQngn == 0 be (frp.trg_ragebcl() > 0 naq frp.trg_ragebcl() < 1) be frp.trg_ragebcl() > 7:
                   		 f += "[FHFCVPVBHF]"
                cevag "",f


   # cevag "[+]Qrgrpgvat Qrohttre gevpxf.."
    #vs yra(gevpxf2) > 0:
    #    	sbe gevpx va gevpxf2:
    #        		cevag "[+]Qrgrpgrq qrohtttre gevpx %f" % gevpx
    #ryfr:
    #gevpxf2= fubjQrohttvatGevpxf(ohs)
    #vs yra(gevpxf2)==0:
    #    	cevag "***Ab qrohttre gevpx qrgrpgrq.\a"
    #		cevag "%f",yra(gevpxf2)


qrs purpx_gevpx_sebz_svyr(gur_svyr):
    s = svyr(gur_svyr, "eo")
    ohs = s.ernq()
    s.pybfr()

    erghea purpx_gevpxf(ohs)

qrs purpx_gevpxf(ohs):
    gevpxf = 0
    erg = []
    sbe gevpx va QRGRPGVBA_GEVPXF:
        vs ohs.ybjre().svaq(QRGRPGVBA_GEVPXF[gevpx].ybjre())>-1:
            erg.nccraq(gevpx)

    erghea erg

#qrs fubjQrohttvatGevpxf(svyranzr, zq5Qve, zft):
qrs fubjQrohttvatGevpxf(ohs):
     v = 0
     purpxGevpxf = []

     cevag "\a[+]Qrgrpgvat Nagv Qrohttre Gevpxf..."
#        sbe yvar va zft:
     sbe gevpx va QROHTTVAT_GEVPXF:
	vs ohs.ybjre().svaq(gevpx.ercynpr("%", "\\").ybjre()) > -1:
#		purpxGevpxf.nccraq(gevpx)
		vs abg gevpx va purpxGevpxf:
			v += 1
			cevag "***Qrgrpgrq gevpx %f (%f)" % (gevpx, QROHTTVAT_GEVPXF[gevpx])
			purpxGevpxf.nccraq(gevpx)
        	vs v == 0:
                        cevag "Ab qrohttre qrgrpgvba gevpx sbhaq"

	#erghea purpxGevpxf

qrs hfntr():
    cevag "Hfntr:", flf.neti[0], "<svyr>"

vs __anzr__ == "__znva__":
#    onaare()
    vs yra(flf.neti) == 1:
        hfntr()
        flf.rkvg(1)
    ryfr:
        znva(flf.neti[1])

qrs fgneg_nanylfvf_ertvfgel():
        sbe yvar va ubfgf:
                sbe pnyyf va ERTVFGEL_PNYYF:
                        vs er.frnepu(pnyyf, yvar):
                                cevag "[+] Znyjner vf Nqqvat n Xrl ng Uvir: ",pnyyf
                                cevag yvar

qrs fgneg_nanylfvf_bayvar():
        cresbezrq=[]
        sbe yvar va ubfgf:
                sbe pnyyf va BAYVAR_JBEX:
                        vs er.frnepu(pnyyf, yvar):
                                vs abg pnyyf va cresbezrq:
                                        cevag "[+] Znyjner Frrzf gb or VEP OBG: Irevsvrq Ol Fgevat :",pnyyf
                                        cresbezrq.nccraq(pnyyf)

qrs fgneg_nanylfvf_flfgrz_pnyyf():
        cresbezrq=[]
        sbe yvar va ubfgf:
                sbe pnyyf va VAGRERFGVAT_PNYYF:
                        vs er.frnepu(pnyyf, yvar):
                                vs abg pnyyf va cresbezrq:
                                        cevag "[+] Sbhaq na Vagrerfgvat pnyy gb: ",pnyyf
                                        cresbezrq.nccraq(pnyyf)




qrs anwzv_purpx():
	cevag "Nanylmvat ertvfgel..."
	fgneg_nanylfvf_ertvfgel()

	cevag "Purpx jurgure guvf ovanel vf n obg..."
	fgneg_nanylfvf_bayvar()

	cevag "Nanylmvat vagrerfgvat pnyyf.."
	fgneg_nanylfvf_flfgrz_pnyyf()


anwzv_purpx()
